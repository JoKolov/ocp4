
{% extends "JNiDefaultBundle::layout.html.twig" %}

{% block title %}
 	Billetterie - {{ parent() }}
{% endblock %}

{% block body %}
	<h3>Réservation de billets d'entrée</h3>

	{% for message in app.session.flashbag.get('danger') %}
		<p class="alert alert-danger">{{ message }}</p>
		<p>Une erreur est survenue lors de la validation du paiement entrainant l'annulation de la procédure de paiement. <br />
		Nous vous invitons à retenter la procédure.<br />
		Si l'erreur se reproduit, contactez nous.</p>
	{% endfor %}

	{% if invoice %}
		<div class="well">
			<p>Jour de la visite : {{ invoice.date|date('d/m/Y') }}</p>
			<p>Email de confirmation : {{ invoice.email }}</p>
			<p>Visiteurs enregistrés :</p>
			<ul>
			{% for visitor in invoice.visitors %}
				<li>{{ visitor.firstName }} {{ visitor.lastName }}, {{ visitor.age }} ans :: {{ visitor.admissionRate }} {{ invoice.currency }}</li>
			{% endfor %}
			</ul>
		</div>
	{% else %}
		<p>aucune réservation enregistrée</p>
	{% endif %}
	

	{# formulaire stripe #}
	<form action="#" name="stripeForm" method="POST">
		<script
			src="https://checkout.stripe.com/checkout.js" class="stripe-button"
			data-key="{{ stripePublicKey }}"
			data-amount="{{ amount }}"
			data-name="Stripe.com"
			data-description="Widget"
			data-image="https://stripe.com/img/documentation/checkout/marketplace.png"
			data-locale="auto"
			data-zip-code="true"
		    data-currency="{{ invoice.currency }}">
		</script>
	</form>

{% endblock %}